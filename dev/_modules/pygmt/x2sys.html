


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>pygmt.x2sys &mdash; PyGMT</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <!-- Google Analytics tracking code -->
    <!-- See https://developers.google.com/analytics/devguides/collection/analyticsjs/ for documentation. -->
    <!-- 'storage': 'none' disables cookies -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
            Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-38125837-7', 'auto', {'storage': 'none'});
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
    <a href="../../index.html"><h2 class="sidebar-title">PyGMT</h2></a>

    
        
        
            <div class="version">
                dev
            </div>
        
    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/first-figure.html">Making your first figure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/frames.html">Frames, ticks, titles, and labels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projections/index.html">Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/coastlines.html">Coastlines and borders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/plot.html">Plotting data points</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help and contributing</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/LICENSE.txt"><i class="fa fa-book fa-fw"></i> License</a></li>
            
                <li class="toctree-l1"><a href="https://forum.generic-mapping-tools.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyGMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../pygmt.html">pygmt</a> &raquo;</li>
        
      <li>pygmt.x2sys</li>
    
    
    <li class="source-link">
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pygmt.x2sys</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GMT supplementary X2SYS module for crossover analysis.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">.clib</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="n">GMTInvalidInput</span>
<span class="kn">from</span> <span class="nn">.helpers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GMTTempFile</span><span class="p">,</span>
    <span class="n">build_arg_string</span><span class="p">,</span>
    <span class="n">data_kind</span><span class="p">,</span>
    <span class="n">dummy_context</span><span class="p">,</span>
    <span class="n">fmt_docstring</span><span class="p">,</span>
    <span class="n">kwargs_to_strings</span><span class="p">,</span>
    <span class="n">unique_name</span><span class="p">,</span>
    <span class="n">use_alias</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">tempfile_from_dftrack</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Saves pandas.DataFrame track table to a temporary tab-separated ASCII text</span>
<span class="sd">    file with a unique name (to prevent clashes when running x2sys_cross),</span>
<span class="sd">    adding a suffix extension to the end.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    track : pandas.DataFrame</span>
<span class="sd">        A table holding track data with coordinate (x, y) or (lon, lat) values,</span>
<span class="sd">        and (optionally) time (t).</span>
<span class="sd">    suffix : str</span>
<span class="sd">        File extension, e.g. xyz, tsv, etc.</span>

<span class="sd">    Yields</span>
<span class="sd">    ------</span>
<span class="sd">    tmpfilename : str</span>
<span class="sd">        A temporary tab-separated value file with a unique name holding the</span>
<span class="sd">        track data. E.g. &#39;track-1a2b3c4.tsv&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmpfilename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;track-</span><span class="si">{</span><span class="n">unique_name</span><span class="p">()[:</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">track</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="n">path_or_buf</span><span class="o">=</span><span class="n">tmpfilename</span><span class="p">,</span>
            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">Z&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">yield</span> <span class="n">tmpfilename</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmpfilename</span><span class="p">)</span>


<div class="viewcode-block" id="x2sys_init"><a class="viewcode-back" href="../../api/generated/pygmt.x2sys_init.html#pygmt.x2sys_init">[docs]</a><span class="nd">@fmt_docstring</span>
<span class="nd">@use_alias</span><span class="p">(</span>
    <span class="n">D</span><span class="o">=</span><span class="s2">&quot;fmtfile&quot;</span><span class="p">,</span>
    <span class="n">E</span><span class="o">=</span><span class="s2">&quot;suffix&quot;</span><span class="p">,</span>
    <span class="n">F</span><span class="o">=</span><span class="s2">&quot;force&quot;</span><span class="p">,</span>
    <span class="n">G</span><span class="o">=</span><span class="s2">&quot;discontinuity&quot;</span><span class="p">,</span>
    <span class="n">I</span><span class="o">=</span><span class="s2">&quot;spacing&quot;</span><span class="p">,</span>
    <span class="n">N</span><span class="o">=</span><span class="s2">&quot;units&quot;</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
    <span class="n">W</span><span class="o">=</span><span class="s2">&quot;gap&quot;</span><span class="p">,</span>
    <span class="n">j</span><span class="o">=</span><span class="s2">&quot;distcalc&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">x2sys_init</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new x2sys track database.</span>

<span class="sd">    x2sys_init is the starting point for anyone wishing to use x2sys; it</span>
<span class="sd">    initializes a set of data bases that are particular to one kind of track</span>
<span class="sd">    data. These data, their associated data bases, and key parameters are given</span>
<span class="sd">    a short-hand notation called an x2sys TAG. The TAG keeps track of settings</span>
<span class="sd">    such as file format, whether the data are geographic or not, and the</span>
<span class="sd">    binning resolution for track indices.</span>

<span class="sd">    Before you can run x2sys_init you must set the environmental parameter</span>
<span class="sd">    X2SYS_HOME to a directory where you have write permission, which is where</span>
<span class="sd">    x2sys can keep track of your settings.</span>

<span class="sd">    Full option list at :gmt-docs:`supplements/x2sys/x2sys_init.html`</span>

<span class="sd">    {aliases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tag : str</span>
<span class="sd">        The unique name of this data type x2sys TAG.</span>

<span class="sd">    fmtfile : str</span>
<span class="sd">        Format definition file prefix for this data set [See Format Definition</span>
<span class="sd">        Files for more information]. Specify full path if the file is not in</span>
<span class="sd">        the current directory.</span>

<span class="sd">        Some file formats already have definition files premade. These include:</span>

<span class="sd">        - mgd77 (for plain ASCII MGD77 data files)</span>
<span class="sd">        - mgd77+ (for enhanced MGD77+ netCDF files)</span>
<span class="sd">        - gmt (for old mgg supplement binary files)</span>
<span class="sd">        - xy (for plain ASCII x, y tables)</span>
<span class="sd">        - xyz (same, with one z-column)</span>
<span class="sd">        - geo (for plain ASCII longitude, latitude files)</span>
<span class="sd">        - geoz (same, with one z-column).</span>

<span class="sd">    suffix : str</span>
<span class="sd">        Specifies the file extension (suffix) for these data files. If not</span>
<span class="sd">        given we use the format definition file prefix as the suffix (see</span>
<span class="sd">        *fmtfile*).</span>

<span class="sd">    discontinuity : str</span>
<span class="sd">        ``d|g``</span>
<span class="sd">        Selects geographical coordinates. Append **d** for discontinuity at the</span>
<span class="sd">        Dateline (makes longitude go from -180 to + 180) or **g** for</span>
<span class="sd">        discontinuity at Greenwich (makes longitude go from 0 to 360</span>
<span class="sd">        [Default]). If not given we assume the data are Cartesian.</span>

<span class="sd">    spacing : str or list</span>
<span class="sd">         ``dx[/dy]``</span>
<span class="sd">         x_inc [and optionally y_inc] is the grid spacing. Append **m** to</span>
<span class="sd">         indicate minutes or **s** to indicate seconds for geographic data.</span>
<span class="sd">         These spacings refer to the binning used in the track bin-index data</span>
<span class="sd">         base.</span>

<span class="sd">    units : str or list</span>
<span class="sd">        ``d|sunit``.</span>
<span class="sd">        Sets the units used for distance and speed when requested by other</span>
<span class="sd">        programs. Append **d** for distance or **s** for speed, then give the</span>
<span class="sd">        desired unit as:</span>

<span class="sd">        - **c** - Cartesian userdist or userdist/usertime</span>
<span class="sd">        - **e** - meters or m/s</span>
<span class="sd">        - **f** - feet or feet/s</span>
<span class="sd">        - **k** - km or kms/hr</span>
<span class="sd">        - **m** - miles or miles/hr</span>
<span class="sd">        - **n** - nautical miles or knots</span>
<span class="sd">        - **u** - survey feet or survey feet/s</span>

<span class="sd">        Default is ``units=[&quot;dk&quot;, &quot;se&quot;]`` (km and m/s) if *discontinuity* is</span>
<span class="sd">        set, and ``units=[&quot;dc&quot;, &quot;sc&quot;]`` otherwise (Cartesian units).</span>

<span class="sd">    {R}</span>
<span class="sd">    {V}</span>

<span class="sd">    gap : str or list</span>
<span class="sd">        ``t|dgap``.</span>
<span class="sd">        Give **t** or **d** and append the corresponding maximum time gap (in</span>
<span class="sd">        user units; this is typically seconds [Infinity]), or distance (for</span>
<span class="sd">        units, see *units*) gap [Infinity]) allowed between the two data points</span>
<span class="sd">        immediately on either side of a crossover. If these limits are exceeded</span>
<span class="sd">        then a data gap is assumed and no COE will be determined.</span>

<span class="sd">    {j}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
        <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tag</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
        <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="s2">&quot;x2sys_init&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">arg_str</span><span class="p">)</span></div>


<div class="viewcode-block" id="x2sys_cross"><a class="viewcode-back" href="../../api/generated/pygmt.x2sys_cross.html#pygmt.x2sys_cross">[docs]</a><span class="nd">@fmt_docstring</span>
<span class="nd">@use_alias</span><span class="p">(</span>
    <span class="n">A</span><span class="o">=</span><span class="s2">&quot;combitable&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="s2">&quot;runtimes&quot;</span><span class="p">,</span>
    <span class="n">D</span><span class="o">=</span><span class="s2">&quot;override&quot;</span><span class="p">,</span>
    <span class="n">I</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">S</span><span class="o">=</span><span class="s2">&quot;speed&quot;</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span>
    <span class="n">Q</span><span class="o">=</span><span class="s2">&quot;coe&quot;</span><span class="p">,</span>
    <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
    <span class="n">W</span><span class="o">=</span><span class="s2">&quot;numpoints&quot;</span><span class="p">,</span>
    <span class="n">Z</span><span class="o">=</span><span class="s2">&quot;trackvalues&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">x2sys_cross</span><span class="p">(</span><span class="n">tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate crossovers between track data files.</span>

<span class="sd">    x2sys_cross is used to determine all intersections between (&quot;external</span>
<span class="sd">    cross-overs&quot;) or within (&quot;internal cross-overs&quot;) tracks (Cartesian or</span>
<span class="sd">    geographic), and report the time, position, distance along track, heading</span>
<span class="sd">    and speed along each track segment, and the crossover error (COE) and mean</span>
<span class="sd">    values for all observables. By default, x2sys_cross will look for both</span>
<span class="sd">    external and internal COEs. As an option, you may choose to project all</span>
<span class="sd">    data using one of the map-projections prior to calculating the COE.</span>

<span class="sd">    Full option list at :gmt-docs:`supplements/x2sys/x2sys_cross.html`</span>

<span class="sd">    {aliases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tracks : pandas.DataFrame or str or list</span>
<span class="sd">        A table or a list of tables with (x, y) or (lon, lat) values in the</span>
<span class="sd">        first two columns. Track(s) can be provided as pandas DataFrame tables</span>
<span class="sd">        or file names. Supported file formats are ASCII, native binary, or</span>
<span class="sd">        COARDS netCDF 1-D data. More columns may also be present.</span>

<span class="sd">        If the filenames are missing their file extension, we will append the</span>
<span class="sd">        suffix specified for this TAG. Track files will be searched for first</span>
<span class="sd">        in the current directory and second in all directories listed in</span>
<span class="sd">        $X2SYS_HOME/TAG/TAG_paths.txt (if it exists). [If $X2SYS_HOME is not</span>
<span class="sd">        set it will default to $GMT_SHAREDIR/x2sys]. (Note: MGD77 files will</span>
<span class="sd">        also be looked for via $MGD77_HOME/mgd77_paths.txt and *.gmt files will</span>
<span class="sd">        be searched for via $GMT_SHAREDIR/mgg/gmtfile_paths).</span>

<span class="sd">    outfile : str</span>
<span class="sd">        Optional. The file name for the output ASCII txt file to store the</span>
<span class="sd">        table in.</span>

<span class="sd">    tag : str</span>
<span class="sd">        Specify the x2sys TAG which identifies the attributes of this data</span>
<span class="sd">        type.</span>

<span class="sd">    combitable : str</span>
<span class="sd">        Only process the pair-combinations found in the file *combitable*</span>
<span class="sd">        [Default process all possible combinations among the specified files].</span>
<span class="sd">        The file *combitable* is created by *x2sys_get*&#39;s -L option</span>

<span class="sd">    runtimes : bool or str</span>
<span class="sd">        Compute and append the processing run-time for each pair to the</span>
<span class="sd">        progress message (use ``runtimes=True``). Pass in a filename (e.g.</span>
<span class="sd">        ``runtimes=&quot;file.txt&quot;``) to save these run-times to file. The idea here</span>
<span class="sd">        is to use the knowledge of run-times to split the main process in a</span>
<span class="sd">        number of sub-processes that can each be launched in a different</span>
<span class="sd">        processor of your multi-core machine. See the MATLAB function</span>
<span class="sd">        split_file4coes.m that lives in the x2sys supplement source code.</span>

<span class="sd">    override : bool or str</span>
<span class="sd">        ``S|N``.</span>
<span class="sd">        Control how geographic coordinates are handled (Cartesian data are</span>
<span class="sd">        unaffected). By default, we determine if the data are closer to one</span>
<span class="sd">        pole than the other, and then we use a cylindrical polar conversion to</span>
<span class="sd">        avoid problems with longitude jumps. You can turn this off entirely</span>
<span class="sd">        with *override* and then the calculations uses the original data (we</span>
<span class="sd">        have protections against longitude jumps). However, you can force the</span>
<span class="sd">        selection of the pole for the projection by appending **S** or **N**</span>
<span class="sd">        for the south or north pole, respectively. The conversion is used</span>
<span class="sd">        because the algorithm used to find crossovers is inherently a</span>
<span class="sd">        Cartesian algorithm that can run into trouble with data that has large</span>
<span class="sd">        longitudinal range at higher latitudes.</span>

<span class="sd">    interpolation : str</span>
<span class="sd">        ``l|a|c``.</span>
<span class="sd">        Sets the interpolation mode for estimating values at the crossover.</span>
<span class="sd">        Choose among:</span>

<span class="sd">        - **l** - Linear interpolation [Default].</span>
<span class="sd">        - **a** - Akima spline interpolation.</span>
<span class="sd">        - **c** - Cubic spline interpolation.</span>

<span class="sd">    coe : str</span>
<span class="sd">        Use **e** for external COEs only, and **i** for internal COEs only</span>
<span class="sd">        [Default is all COEs].</span>

<span class="sd">    {R}</span>

<span class="sd">    speed : str or list</span>
<span class="sd">        ``l|u|hspeed``.</span>
<span class="sd">        Defines window of track speeds. If speeds are outside this window we do</span>
<span class="sd">        not calculate a COE. Specify:</span>

<span class="sd">        - **l** sets lower speed [Default is 0].</span>
<span class="sd">        - **u** sets upper speed [Default is Infinity].</span>
<span class="sd">        - **h** does not limit the speed but sets a lower speed below which \</span>
<span class="sd">        headings will not be computed (i.e., set to NaN) [Default calculates \</span>
<span class="sd">        headings regardless of speed].</span>

<span class="sd">        For example, you can use ``speed=[&quot;l0&quot;, &quot;u10&quot;, &quot;h5&quot;] to set a lower</span>
<span class="sd">        speed of 0, upper speed of 10, and disable heading calculations for</span>
<span class="sd">        speeds below 5.</span>

<span class="sd">    {V}</span>

<span class="sd">    numpoints : int</span>
<span class="sd">        Give the maximum number of data points on either side of the crossover</span>
<span class="sd">        to use in the spline interpolation [Default is 3].</span>

<span class="sd">    trackvalues : bool</span>
<span class="sd">        Report the values of each track at the crossover [Default reports the</span>
<span class="sd">        crossover value and the mean value].</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    crossover_errors : pandas.DataFrame or None</span>
<span class="sd">        Table containing crossover error information.</span>
<span class="sd">        Return type depends on whether the outfile parameter is set:</span>

<span class="sd">        - pandas.DataFrame table with (x, y, ..., etc) if outfile is not set</span>
<span class="sd">        - None if outfile is set (track output will be stored in outfile)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
        <span class="n">file_contexts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">:</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_contexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dummy_context</span><span class="p">(</span><span class="n">track</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
                <span class="c1"># find suffix (-E) of trackfiles used (e.g. xyz, csv, etc) from</span>
                <span class="c1"># $X2SYS_HOME/TAGNAME/TAGNAME.tag file</span>
                <span class="n">lastline</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;X2SYS_HOME&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.tag&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>  <span class="c1"># e.g. &quot;-Dxyz -Etsv -I1/1&quot;</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lastline</span><span class="o">.</span><span class="n">split</span><span class="p">()):</span>  <span class="c1"># sort list alphabetically</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;-E&quot;</span><span class="p">,</span> <span class="s2">&quot;-D&quot;</span><span class="p">)):</span>  <span class="c1"># prefer -Etsv over -Dxyz</span>
                        <span class="n">suffix</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>  <span class="c1"># e.g. tsv (1st choice) or xyz (2nd choice)</span>

                <span class="c1"># Save pandas.DataFrame track data to temporary file</span>
                <span class="n">file_contexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tempfile_from_dftrack</span><span class="p">(</span><span class="n">track</span><span class="o">=</span><span class="n">track</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">track</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">GMTTempFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmpfile</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">ExitStack</span><span class="p">()</span> <span class="k">as</span> <span class="n">stack</span><span class="p">:</span>
                <span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">file_contexts</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">outfile</span> <span class="o">=</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="o">*</span><span class="n">fnames</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">),</span> <span class="s2">&quot;-&gt;&quot;</span> <span class="o">+</span> <span class="n">outfile</span><span class="p">])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="s2">&quot;x2sys_cross&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">arg_str</span><span class="p">)</span>

            <span class="c1"># Read temporary csv output to a pandas table</span>
            <span class="k">if</span> <span class="n">outfile</span> <span class="o">==</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>  <span class="c1"># if outfile isn&#39;t set, return pd.DataFrame</span>
                <span class="c1"># Read the tab-separated ASCII table</span>
                <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                    <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Column names are on 2nd row</span>
                    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>  <span class="c1"># Skip the 3rd row with a &quot;&gt;&quot;</span>
                    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  <span class="c1"># Datetimes on 3rd and 4th column</span>
                <span class="p">)</span>
                <span class="c1"># Remove the &quot;# &quot; from &quot;# x&quot; in the first column</span>
                <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:]})</span>
            <span class="k">elif</span> <span class="n">outfile</span> <span class="o">!=</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>  <span class="c1"># if outfile is set, output in outfile only</span>
                <span class="n">table</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">table</span></div>
</pre></div>

           </div>
           
          </div>
          
<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2020, The PyGMT Developers.
      
        <span class="commit">
          Revision <code><a href="https://github.com/GenericMappingTools/pygmt/commit/d3e131a863a008f14979e7d9764cc6167156376f">d3e131a</a></code>.
        </span>
      

    </p>
  </div>
<p>
Built with <a href="http://sphinx-doc.org/">Sphinx</a>
using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
provided by <a href="https://readthedocs.org">Read the Docs</a>
</p>
<p>
This website uses Google Analytics to gather usage statistics.
However, it does not use cookies or track you across different websites.
Page view data are used to help us improve the site and provide an estimate of the
software usage.
</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>